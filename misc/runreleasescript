#!/bin/sh

#
# For cleaning up generated files and running the release script for a
# proper build - to do a buildfresh add -b -y to release script parameters,
# and to do all table files languages add -l to release script parameters.
#

VERSION="2013.1.3"
TABLEFILESOPT="-l"
BUILDFRESHOPT=""
NETWORK="NO"

appstop -y

cd $DCS

find . -name afiedt.buf -print | xargs rm  -f
find . -name sqlnet.log -print | xargs rm  -f
find . -name jim.tmp -print | xargs rm  -f
find . -name rob.tmp -print | xargs rm  -f
find . -name ".#*" -print | xargs rm  -f

rm -f $DCS_TMPDIR/+~JF*.tmp

if [ "$NETWORK" = "TRUE" ]
then
	rm -rf client/websource/classes/Helpfiles
	rm -rf server/run/reports
	rm -rf server/run/datastream
fi

if [ "$TABLEFILESOPT" != "" ]
then
	rm -rf client/websource/classes/Tablefiles
fi

if [ "$BUILDFRESHOPT" = "" ]
then
	$DCS/server/source/bin/lis/buildincludes -c
fi

if [ "$NETWORK" = "TRUE" ]
then
	cvs -q update -d -P
fi

cd $DCS/release/$VERSION/lis

if [ "$BUILDFRESHOPT" = "" ]
then
	synchronisetables -r -d
fi

release$VERSION.sh -d -f -r $TABLEFILESOPT -z $BUILDFRESHOPT

appstart -y

#checkinterfaces

